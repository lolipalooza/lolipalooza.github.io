---
thread: "(Display.template) Mejor funcionalidad Hide Posts"
id_msg: 4885
date: "2013-06-26 21:43:45"

subject: "(Display.template) Mejor funcionalidad Hide Posts"
user: "yap320sorgesoureDug"

modified_time: 2015-10-28 16:46:24
modified_name: "yap320sorgesoureDug"
icon: xx



edit_reason: "pos nomas"
---
<span style="font-size: 14pt;" class="bbc_size"><strong>Modificación sobre Display.template</strong>:</span><br /><span style="color: green;" class="bbc_color"><span style="font-size: 18pt;" class="bbc_size"><strong><span class="bbc_u">Mejor funcionalidad Hide Posts</span></strong></span></span><br /><br />Antes de continuar, hagamos una recolección de datos que nos ayudarán a desarrollar mejor nuestra modificación para embellecer el HidePost:<br />Condiciones que utiliza el Display.template para tomar decisiones:<br /><ul class="bbc_list"><li><strong>$message&#91;&#039;post_hidden&#039;]</strong>: si es == 1, el post actual está oculto, si es 0, no lo está.</li><li><strong>allowedTo(&#039;modhide_post&#039;)</strong>: true or false, 0 o 1, si el usuario tiene los permisos para ocultar.</li><li><strong>$message&#91;&#039;member&#039;]&#91;&#039;id&#039;] &lt;&gt; $context&#91;&#039;user&#039;]&#91;&#039;id&#039;]</strong>: el post pertenece al usuario?.</li><li><strong>$message&#91;&#039;member&#039;]&#91;&#039;is_guest&#039;]</strong>: el usuario es un visitante? (no está registrado)</li><li><strong>$modSettings&#91;&#039;modhideShowModName&#039;]</strong>: está permitido mostrar el nombre del jai estafo que oculta posts? Si no es asi eres un COBARDE!!1!</li><li><strong>$message&#91;&#039;hidden_by&#039;]</strong>: variable que alberga la palabra &quot;un moderador&quot; (que se quiere mantener en el anonimato para evitar ser molido a golpes y así)</li><li><strong>$message&#91;&#039;hidden_by_name&#039;]</strong>: variable que acumula el nombre del joputa que ocultó el post (al menos es valiente y da la cara, o bueno, mejor dicho, el nick).</li></ul><br />Ahora si... Comencemos!<br /><br />Buscar código:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">echo &#039;<br />&lt;div class=&quot;seperate&quot;&gt;&#039;;</code><br />Agregar lo siguiente(si se agrega antes, no se verá el color de fondo del post, si se agrega después, este fondo se verá, decidir!!):<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">// El post actual está oculto?<br />if ($message&#91;&#039;post_hidden&#039;] == 1)<br />{<br /></code><br />OJO: aquí estamos abriendo con &quot;{&quot;. Tenemos que cerrar al finaaal del while($message = $context&#91;&#039;get_message&#039;]()).<br />Tranquilos, más adelante lo explicamos y lo haremos.<br /><br />Ahora agregaremos lo siguiente:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">if ($message&#91;&#039;hidden_by&#039;] == 0)<br />&nbsp;&nbsp;&nbsp;$modHideName = $txt&#91;&#039;modhideName&#039;];<br />elseif (($modSettings&#91;&#039;modhideShowModName&#039;] == 1) || allowedTo(&#039;modhide_post&#039;))<br />&nbsp;&nbsp;&nbsp;$modHideName = $message&#91;&#039;hidden_by_name&#039;];<br />else<br />&nbsp;&nbsp;&nbsp;$modHideName = $txt&#91;&#039;modhideName&#039;];<br /></code>Con ésto inicializamos las variables del mensaje que se mostrará acerca del post oculto.<br /><br />Luego agregamos:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">echo &#039;<br />&lt;div class=&quot;hidden&quot;&gt;&#039;, $txt&#91;&#039;hidden_label&#039;], &#039; &#039; ,$modHideName, &#039;.&lt;br /&gt;&#039; ,$txt&#91;&#039;reason_label&#039;], &#039;: &#039;, $message&#91;&#039;hidden_reason&#039;],&#039;&lt;/div&gt;&#039;;<br /></code>Lo cual traducido de HTML en nuestro idioma quiere decir:<br />&quot;Este post ha sido ocultado por ((nickname mod ó mod anónimo))<br />Razón: ((la razon que se haya especificado))&quot;<br /><br />Pero si no se especifica la razón, ese espacio se va a ver en blanco así que doy las siguientes alternativas:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">echo &#039;<br />&lt;div class=&quot;hidden&quot;&gt;&#039;, $txt&#91;&#039;hidden_label&#039;], &#039; &#039; ,$modHideName, &#039;.&lt;br /&gt;&#039; ,<br />$message&#91;&#039;hidden_reason&#039;]&gt;0? $txt&#91;&#039;reason_label&#039;] . &#039;: &#039; . $message&#91;&#039;hidden_reason&#039;] : &#039;&#039;,&#039;&lt;/div&gt;&#039;;<br /></code>Si no se especifica ninguna razón sólo dirá: &quot;Este post ha sido ocultado por ((mod))&quot; y hasta ahí.<br /><br />ó<br /><br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">echo &#039;<br />&lt;div class=&quot;hidden&quot;&gt;&#039;, $txt&#91;&#039;hidden_label&#039;], &#039; &#039; ,$modHideName, &#039;.&lt;br /&gt;&#039; ,<br />$txt&#91;&#039;reason_label&#039;], &#039;: &#039;, $message&#91;&#039;hidden_reason&#039;]&gt;0? $message&#91;&#039;hidden_reason&#039;] : &#039;Injustificada.&#039;,&#039;&lt;/div&gt;&#039;;<br /></code>Si no se especifica ninguna razón entonces dirá:<br />&quot;Este post ha sido ocultado por ((mod))<br />Razón: Injustificada.&quot;<br /><br />Elijan las que más placer sexual les provoque....<br /><br />Luego, añadimos la posibilidad de desocultar post, para los mod:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">// Show the Unhide Post option - because you can moderate<br />if (allowedTo(&#039;modhide_post&#039;))<br />echo &#039;<br />Click &lt;a href=&quot;&#039;, $scripturl, &#039;?action=modunhidepost;topic=&#039;, $context&#91;&#039;current_topic&#039;], &#039;.0;msg=&#039;, $message&#91;&#039;id&#039;], &#039;;&#039;, $context&#91;&#039;session_var&#039;], &#039;=&#039;, $context&#91;&#039;session_id&#039;], &#039;&quot; onclick=&quot;return confirm(\&#039;&#039;, $txt&#91;&#039;unhide_confirm&#039;], &#039;?\&#039;);&quot;&gt;aqui&lt;/a&gt; para recuperar post.&#039;;<br /></code><br />Ya terminamos de agregar todo lo que se va a ver en un post si éste está oculto.<br />Ahora sí, cerramos la llave condicional, agregamos un else, y nos vamos al resto del código para mostrar posts normales:<br /><br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">} else {<br /></code><br />Luego vamos a comentar los trozos de código que ya no nos harán falta, dentro del código de mostrar un post normal.<br />Nótese que el else abrió otra llave &quot;{&quot; que hay que cerrar al final del bucle while... Tranquilos, lo haremos mas abajo.<br /><br />/* Comentar */ los siguientes fragmentos de código:<br /><div class="codeheader">Código: (Insertar comentarios) <a href="#" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Mod Hide Post<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($message&#91;&#039;post_hidden&#039;] == 1) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!allowedTo(&#039;modhide_post&#039;) &amp;&amp; (($message&#91;&#039;member&#039;]&#91;&#039;id&#039;] &lt;&gt; $context&#91;&#039;user&#039;]&#91;&#039;id&#039;]) || ($message&#91;&#039;member&#039;]&#91;&#039;is_guest&#039;])))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message&#91;&#039;subject&#039;] = &#039;*****&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /></code><br /><div class="codeheader">Código: (Insertar comentarios) <a href="#" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($message&#91;&#039;post_hidden&#039;] == 1) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class=&quot;hide_button&quot;&gt;&lt;a href=&quot;&#039;, $scripturl, &#039;?action=modunhidepost;topic=&#039;, $context&#91;&#039;current_topic&#039;], &#039;.0;msg=&#039;, $message&#91;&#039;id&#039;], &#039;;&#039;, $context&#91;&#039;session_var&#039;], &#039;=&#039;, $context&#91;&#039;session_id&#039;], &#039;&quot; onclick=&quot;return confirm(\&#039;&#039;, $txt&#91;&#039;unhide_confirm&#039;], &#039;?\&#039;);&quot;&gt;&#039;, $txt&#91;&#039;modunhide&#039;], &#039;&lt;/a&gt;&lt;/li&gt;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br /></code>En éste último fragmento, no olvidar comentar la última llave así:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class=&quot;hide_button&quot;&gt;&lt;a href=&quot;&#039;, $scripturl, &#039;?action=modhidepost;topic=&#039;, $context&#91;&#039;current_topic&#039;], &#039;.0;msg=&#039;, $message&#91;&#039;id&#039;], &#039;;&#039;, $context&#91;&#039;session_var&#039;], &#039;=&#039;, $context&#91;&#039;session_id&#039;], &#039;&quot;&gt;&#039;, $txt&#91;&#039;modhide&#039;], &#039;&lt;/a&gt;&lt;/li&gt;&#039;;<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /></code>O nos dará problemas la página al tratar de abrir cualquier hilo.<br /><br /><div class="codeheader">Código: (Insertar comentarios) <a href="#" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Mod Hide Post<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($message&#91;&#039;post_hidden&#039;] == 1) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($message&#91;&#039;hidden_by&#039;] == 0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$modHideName = $txt&#91;&#039;modhideName&#039;];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif (($modSettings&#91;&#039;modhideShowModName&#039;] == 1) || allowedTo(&#039;modhide_post&#039;))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$modHideName = $message&#91;&#039;hidden_by_name&#039;];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$modHideName = $txt&#91;&#039;modhideName&#039;];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;&lt;div class=&quot;hidden&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr width=&quot;100%&quot; size=&quot;1&quot; class=&quot;hrcolor&quot; /&gt;&#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$txt&#91;&#039;hidden_label&#039;], &#039; &#039; ,$modHideName, &#039;.&lt;br /&gt;&#039; ,$txt&#91;&#039;reason_label&#039;], &#039;: &#039;, $message&#91;&#039;hidden_reason&#039;],&#039;&lt;/div&gt;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!allowedTo(&#039;modhide_post&#039;) &amp;&amp; (($message&#91;&#039;member&#039;]&#91;&#039;id&#039;] &lt;&gt; $context&#91;&#039;user&#039;]&#91;&#039;id&#039;]) || ($message&#91;&#039;member&#039;]&#91;&#039;is_guest&#039;])))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message&#91;&#039;body&#039;] = &#039;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /></code><br />Listo.<br />Todos los fragmentos relacionados al hide/unhide han sido comentados.<br />Ahora, como lo prometido es deuda, entonces nos vamos a lo de cerrar con la llave antes mencionada:<br /><br />Agregar la llave de cierre. ¿dónde? Depende....<br />Si agregaste el condicional antes del &lt;div class=&quot;separate&quot;&gt;, entonces debes agregarla después del cierre &lt;/div&gt;.<br />Si agregaste el condicional despues del div-separate, entonces debes agregarla antes del cierre.<br /><br />Así:<br /><div class="codeheader">Código: (ubícate en el siguiente fragmento) <a href="#" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Show the member&#039;s signature?<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!empty($message&#91;&#039;member&#039;]&#91;&#039;signature&#039;]) &amp;&amp; empty($options&#91;&#039;show_no_signatures&#039;]) &amp;&amp; $context&#91;&#039;signature_enabled&#039;])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;signature&quot; id=&quot;msg_&#039;, $message&#91;&#039;id&#039;], &#039;_signature&quot;&gt;&#039;, $message&#91;&#039;member&#039;]&#91;&#039;signature&#039;], &#039;&lt;/div&gt;&#039;;&nbsp;&nbsp;&nbsp;<br />/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arcade_champs_sig($message);<br />*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span class=&quot;botslice&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr class=&quot;post_separator&quot; /&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;---------------------------------------------------------- llave cierre opción 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&#039;;&nbsp; &nbsp; &nbsp; &nbsp;&lt;---------------------------------------------- ESTE ES el div del cierre<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;--------------------------------------------------------- llave cierre opción 2<br />&nbsp;&nbsp;&nbsp;}<br /></code><br />Sólo vas a elegir UNA de las 2 opciones. Ni se te ocurra meter las 2 llaves de cierre o tu programa se hechará dos....<br />Y eso es todo. Disfruten de un código funcionando como a ustedes les dé la gana joputas malparidos! :p<br /><br />PD: MÁMENME!<br />PD2: <span class="spoiler">Que se pudra <del>Flandre</del> Flanders!</span>
