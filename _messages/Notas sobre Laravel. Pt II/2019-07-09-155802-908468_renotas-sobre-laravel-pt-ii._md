---
thread: "Notas sobre Laravel. Pt II"
id_msg: 908468
date: "2019-07-09 15:58:02"

subject: "Re:Notas sobre Laravel. Pt II"
user: "yap320sorgesoureDug"



icon: xx




---
(<a href="http://smf.halabalooza.orgy/index.php/topic,3378.msg908462.html#msg908462" class="bbc_link">Volver al índice</a>)<br /><div align="center"><span style="font-size: 18pt;" class="bbc_size"><span style="font-family: times new roman;" class="bbc_font"><strong>5. <em>Controladores</em></strong></span></span><br />(<a href="https://styde.net/controladores-en-laravel/" class="bbc_link new_win" target="_blank">https://styde.net/controladores-en-laravel/</a>)</div><br />Para crear controlador (desde cónsola):<br />&gt; php artisan make:controller NombreControlador<br /><br />Ruta de los controladores:<br />app/Http/Controllers<br /><br />Ejemplo de controlador:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code"><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">App</span><span style="color: #007700">\</span><span style="color: #0000BB">Http</span><span style="color: #007700">\</span><span style="color: #0000BB">Controllers</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">Illuminate</span><span style="color: #007700">\</span><span style="color: #0000BB">Http</span><span style="color: #007700">\</span><span style="color: #0000BB">Request</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">UserController&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Controller<br /></span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">index</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">&#039;Usuarios&#039;</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;}<br />}<br /></span></span></code><br />Cambios realizados en routes/web.php para hacer uso del controlador:<br />Se reemplazó lo que se tenía:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">Route::get(&#039;/usuarios&#039;, function () {<br />&nbsp;&nbsp;&nbsp;return &#039;Usuarios&#039;;<br />});<br /></code>Por:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">Route::get(&#039;/usuarios&#039;, &#039;UserControlle@index&#039;);<br /></code><br />Agregando el resto de lógica para el controlador, para poder ordenar el archivo de rutas:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">class UserController extends Controller<br />{<br />&nbsp;&nbsp;&nbsp;public function index()<br />&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &#039;Usuarios&#039;;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;public function show($id)<br />&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;Mostrando detalle del usuario: {$id}&quot;;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;public function create()<br />&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;Crear nuevo usuario&quot;;<br />&nbsp;&nbsp;&nbsp;}<br />}<br /></code><br />Cambios en routes/web.php:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">Route::get(&#039;/usuarios&#039;, &#039;UserController@index&#039;);<br /><br />Route::get(&#039;/usuarios/{id}&#039;, &#039;UserController@show&#039;)<br />&nbsp;&nbsp;&nbsp;-&gt;where(&#039;id&#039;, &#039;[0-9]+&#039;);<br /><br />Route::get(&#039;/usuarios/nuevo&#039;, &#039;UserController@create&#039;);<br /></code><br />Creando otro controlador y añadiéndole la lógica necesaria:<br />&gt; php artisan make:controller WelcomeUserController<br /><br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code"><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">App</span><span style="color: #007700">\</span><span style="color: #0000BB">Http</span><span style="color: #007700">\</span><span style="color: #0000BB">Controllers</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">Illuminate</span><span style="color: #007700">\</span><span style="color: #0000BB">Http</span><span style="color: #007700">\</span><span style="color: #0000BB">Request</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">WelcomeUserController&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Controller<br /></span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">index</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$nickname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ucfirst</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$nickname</span><span style="color: #007700">)&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Bienvenido&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$name</span><span style="color: #007700">}</span><span style="color: #DD0000">,&nbsp;tu&nbsp;apodo&nbsp;es&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$nickname</span><span style="color: #007700">}</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Bienvenido&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$name</span><span style="color: #007700">}</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;}<br />}<br /></span></span></code><br />Nuevos cambios en routes/web.php:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">Route::get(&#039;/saludo/{name}/{nickname?}&#039;, &#039;WelcomeUserController@index&#039;);<br /></code><br />Si solamente vas a tener un solo método dentro del controlador, puedes simplificar el código así:<br /><br />En routes/web.php:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">Route::get(&#039;/saludo/{name}/{nickname?}&#039;, &#039;WelcomeUserController&#039;);<br /></code><br />En WelcomeUserController.php:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">class WelcomeUserController extends Controller<br />{<br />&nbsp;&nbsp;&nbsp;public function __invoke($name, $nickname = null)&nbsp;&nbsp;&nbsp;// cambiamos &quot;index&quot; por &quot;__invoke&quot;<br />&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = ucfirst($name);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nickname) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;Bienvenido {$name}, tu apodo es {$nickname}&quot;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;Bienvenido {$name}&quot;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;}<br />}<br /></code><br />Notas aparte:<br />Respecto a testing:<br /><br />- Puedes verificar en el archivo storage/logs/laravel.log<br />- Se puede expandir más la lógica dentro de los archivos que realizan las pruebas, para mostrar más información sobre los errores:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">/** @test */<br />function it_loads_the_new_users_page()<br />{<br />&nbsp;&nbsp;&nbsp;$this-&gt;withoutExceptionHandling();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Mostrar excepción<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;$this-&gt;get(&#039;/usuarios/nuevo&#039;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;assertStatus(200)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;assertSee(&#039;Crear nuevo usuario&#039;);<br />}</code>
