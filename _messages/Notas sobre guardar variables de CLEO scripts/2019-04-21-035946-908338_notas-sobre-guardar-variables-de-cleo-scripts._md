---
thread: "Notas sobre guardar variables de CLEO scripts"
id_msg: 908338
date: "2019-04-21 03:59:46"

subject: "Notas sobre guardar variables de CLEO scripts"
user: "syn437sorgesoureDug"



icon: xx




---
<div align="center"><span style="font-family: georgia;" class="bbc_font"><span style="color: limegreen;" class="bbc_color"><span style="font-size: 18pt;" class="bbc_size"><strong><span class="bbc_u"> <img src="/assets/smf/smileys/sunny.gif" alt="&#58;sunny&#58;" title="Sunny" class="smiley" /> Notas sobre guardar variables de CLEO scripts</span></strong></span></span></span></div><br />Existen diversas maneras de guardar datos que provienen de scripts de CLEO.<br /><br />Una vez implementé un método sumamente engorroso para guardar una larga lista de datos en un archivo .sav organizado por mi, desde unos scripts de CLEO que pretendían hacerla de un storyline.<br /><br />En este hilo cubriremos un método más sencillo (aunque limitado) de guardar información de CLEO scripts. Pudieramos a partir de ésto idear una mejor y más eficiente forma de crear saves provenientes de un CLEO que quiera hacer las veces de un MAIN.SCM<br /><br />¿En qué consiste?<br /><br />Pues fácil. Creas un nuevo hilo de CLEO, y habilitas la función para guardar datos así:<br /><br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">{$CLEO .cs}<br />thread &#039;ExampleThread&#039;<br /><br />0A95: enable_thread_saving</code><br />Luego, cada vez que pases por un punto de salvado, todas las variables locales habidas en ese hilo serán guardadas en la carpeta CLEO/CLEO_SAVES, dependiendo del slot en donde guardes. Si guardas en el slot 1, por ejemplo, entonces en la ubicación &#039;Documents/GTA San Andreas User Files&#039; se guardará el archivo <em>GTASAsf<strong>1</strong>.b</em>, y al mismo tiempo, en CLEO/cleo_saves se guardará el archivo <em>cs<strong>1</strong>.sav</em>.<br /><br />Lamentablemente, solo se guardan las variables, mas no lo que haya en memoria de programa. Es decir, si creo algo como ésto en el CLEO script:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">:STORE_DATA_HERE<br />hex<br />00000000 00000000 00000000 00000000<br />end</code><br />Y trato de escribir datos en ese espacio, nada será gurdado en mi archivito <em>cleo/cleo_saves/csX.sav</em>. <img src="/assets/smf/smileys/31192.gif" alt="&#58;lloron&#58;" title="" class="smiley" /><br /><br />Aquí dejo un script de ejemplo, diseñado para poner a prueba dicha funcionalidad.<br /><br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">repeat<br />wait 0<br />&nbsp; &nbsp; if 0ADC:&nbsp; &nbsp;test_cheat &quot;SAVE&quot;<br />&nbsp; &nbsp; then<br />&nbsp; &nbsp; &nbsp; &nbsp; 03D8: show_save_screen<br />&nbsp; &nbsp; &nbsp; &nbsp; repeat <br />&nbsp; &nbsp; &nbsp; &nbsp; wait 0 ms<br />&nbsp; &nbsp; &nbsp; &nbsp; until 03D9: save_done<br />&nbsp; &nbsp; &nbsp; &nbsp; 016A: fade 0 time 0<br />&nbsp; &nbsp; &nbsp; &nbsp; fade 1 time 1000<br />&nbsp; &nbsp; end<br /><br />&nbsp; &nbsp; if 0ADC:&nbsp; &nbsp;test_cheat &quot;GXT1&quot;<br />&nbsp; &nbsp; then<br />&nbsp; &nbsp; &nbsp; &nbsp; 4@v = &quot;Test String 1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; 8@v = &quot;Test String 1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 4@ 0<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 5@ 4<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 6@ 8<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 7@ 12<br />&nbsp; &nbsp; &nbsp; &nbsp; 0ACE: show_formatted_text_box &quot;stored ~r~%s~s~ in MyGXTTest space&quot; 4@v<br />&nbsp; &nbsp; end<br /><br />&nbsp; &nbsp; if 0ADC:&nbsp; &nbsp;test_cheat &quot;GXT2&quot;<br />&nbsp; &nbsp; then<br />&nbsp; &nbsp; &nbsp; &nbsp; 4@v = &quot;Test String 2&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; 8@v = &quot;Test String 2&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 4@ 0<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 5@ 4<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 6@ 8<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @StoreData 3 @MyGXTTest 7@ 12<br />&nbsp; &nbsp; &nbsp; &nbsp; 0ACE: show_formatted_text_box &quot;stored ~r~%s~s~ in MyGXTTest space&quot; 4@v<br />&nbsp; &nbsp; end<br /><br />&nbsp; &nbsp; if 0ADC:&nbsp; &nbsp;test_cheat &quot;GXTT&quot;<br />&nbsp; &nbsp; then<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @GetData 2 @MyGXTTest 0 ret 4@<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @GetData 2 @MyGXTTest 4 ret 5@<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @GetData 2 @MyGXTTest 8 ret 6@<br />&nbsp; &nbsp; &nbsp; &nbsp; 0AB1: @GetData 2 @MyGXTTest 12 ret 7@<br />&nbsp; &nbsp; &nbsp; &nbsp; 0ACE: show_formatted_text_box &quot;MyGXTTest: ~r~%s~s~&quot; 4@v<br />&nbsp; &nbsp; end<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if 0ADC:&nbsp; &nbsp;test_cheat &quot;GXTD&quot;<br />&nbsp; &nbsp; then 0ACE: show_formatted_text_box &quot;MyGXTTest: ~r~%s~s~&quot; 8@v<br />&nbsp; &nbsp; end<br /><br />until false<br /><br />:MyGXTTest<br />hex<br />00000000 00000000 00000000 00000000<br />end<br /><br />// Nota: las subrutinas @GetData y @StoreData han sido omitidas en este ejemplo<br /></code><br />El problema de este lindo y bello método, es que la cantidad de variables que podemos guardar están limitadísimas a la paupérrima cantidad de 32 variables (0@ ~ 31@).<br /><br />¿Cómo podemos expandir dicho límite?<br /><br />En <a href="https://gtaforums.com/topic/420215-a-q-about-cleo-saves/?tab=comments#comment-1059391385" class="bbc_link new_win" target="_blank">este hilo </a>hay una sugerencia que aún no la he probado, pero quedará pendiente para el futuro:<br /><br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">{$CLEO}<br />thread &#039;THREAD&#039;<br />if 0@ == 1<br />then goto @start1<br />end<br />if 0@ == 2<br />then goto @start2<br />end<br />if 0@ == 3<br />then goto @start<br />end<br />0A92: create_custom_thread &quot;thread.cs&quot; {with parameters} 1<br />0A92: create_custom_thread &quot;thread.cs&quot; {with parameters} 2<br />0A92: create_custom_thread &quot;thread.cs&quot; {with parameters} 3<br />0A93: end_custom_thread<br /><br />:start1<br />// contents<br /><br />:start2<br />// contents<br /><br />:start3<br />// contents</code><br />Eso es todo por ahora.<br />C-YA!<br /><br /><img src="/assets/smf/smileys/1f618.png" alt="&#58;fb_kiss&#58;" title="Kiss" class="smiley" />
