---
thread: "Mejorando barra de posteo r&aacute;pido (Quick Reply)"
id_msg: 5608
date: "2015-11-05 23:54:45"

subject: "Re:Mejorando barra de posteo r&aacute;pido (Quick Reply)"
user: "yap320sorgesoureDug"

modified_time: 2015-11-05 23:57:39
modified_name: "yap320sorgesoureDug"
icon: xx



edit_reason: "pos nomas"
---
<span style="font-size: 14pt;" class="bbc_size"><strong>Modificación sobre Display y Display.template</strong>:</span><br /><span style="color: green;" class="bbc_color"><span style="font-size: 18pt;" class="bbc_size"><strong><span class="bbc_u">Mejorando Barra de Posteo Rápido</span></strong></span></span><br /><span style="font-size: 14pt;" class="bbc_size"><strong>(Agregando botoncito cute de smileys <img src="/assets/smf/smileys/271186.gif" alt="&#58;smoke&#58;" title="Smoke" class="smiley" />)</strong></span><br /><br />Para poder agregar el botoncito pendejo de smileys a la barra de respuesta rápida ha sido un verdadero dolor de cabeza, pero aquí les sintetizo los descubrimientos sobre el como:<br /><br />Primero, es necesario añadir una funcionalidad en <strong>Display.php</strong> tomada desde <strong><em>Post.php</em></strong>.<br />Esta funcionalidad lo que hace es definir elementos de &quot;<em>richedit template</em>&quot; entre otras hueas que son necesarias para integrar las líneas de código desde <em>Post.template </em>hacia <em>Display.template</em>:<br /><br />Buscar código en <em>Post.php</em>:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;// Needed for the editor and message icons.<br />&nbsp;&nbsp;&nbsp;require_once($sourcedir . &#039;/Subs-Editor.php&#039;);<br /><br />&nbsp;&nbsp;&nbsp;// Now create the editor.<br />&nbsp;&nbsp;&nbsp;$editorOptions = array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;id&#039; =&gt; &#039;message&#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;value&#039; =&gt; $context&#91;&#039;message&#039;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;labels&#039; =&gt; array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;post_button&#039; =&gt; $context&#91;&#039;submit_label&#039;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// add height and width for the editor<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;height&#039; =&gt; &#039;175px&#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;width&#039; =&gt; &#039;100%&#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// We do XML preview here.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;preview_type&#039; =&gt; 2,<br />&nbsp;&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;create_control_richedit($editorOptions);<br /><br />&nbsp;&nbsp;&nbsp;// Store the ID.<br />&nbsp;&nbsp;&nbsp;$context&#91;&#039;post_box_name&#039;] = $editorOptions&#91;&#039;id&#039;];<br /></code><br />Añadirlo en <em>Display.php</em> despues de:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// We need to reverse the start as well in this case.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_REQUEST&#91;&#039;start&#039;] = empty($options&#91;&#039;view_newest_first&#039;]) ? $context&#91;&#039;start_from&#039;] : $context&#91;&#039;total_visible_posts&#039;] - $context&#91;&#039;start_from&#039;] - 1;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;}<br /></code><br />Listo, el siguiente paso es integrar las líneas de código en Display.template para que aparesca el pendejo botoncito que te abre una nueva ventana (popup) con todos los smileys.<br />En principio, bastaría con agregar las siguientes líneas de código donde se indica:<br /><strong>Display.template.php</strong>:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img class=&quot;bbcimg&quot; width=&quot;23&quot; height=&quot;22&quot; align=&quot;bottom&quot; title=&quot;Blink&quot; alt=&quot;Blink&quot; src=&quot;&#039;, $settings&#91;&#039;theme_url&#039;], &#039;/images/bbc/blink.gif&quot; onclick=&quot;bibicoud(\&#039;blink\&#039;,\&#039;blink\&#039;,\&#039;&#039; . $my_textarea . &#039;\&#039;); void(0);&quot;&gt;&lt;/img&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img class=&quot;bbcimg&quot; width=&quot;23&quot; height=&quot;22&quot; align=&quot;bottom&quot; title=&quot;Insertar Código&quot; alt=&quot;Insertar Código&quot; src=&quot;&#039;, $settings&#91;&#039;theme_url&#039;], &#039;/images/bbc/code.gif&quot; onclick=&quot;bibicoud(\&#039;code\&#039;,\&#039;code\&#039;,\&#039;&#039; . $my_textarea . &#039;\&#039;); void(0);&quot;&gt;&lt;/img&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img class=&quot;bbcimg&quot; width=&quot;23&quot; height=&quot;22&quot; align=&quot;bottom&quot; title=&quot;Insertar Cita&quot; alt=&quot;Insertar Cita&quot; src=&quot;&#039;, $settings&#91;&#039;theme_url&#039;], &#039;/images/bbc/quote.gif&quot; onclick=&quot;bibicoud(\&#039;quote\&#039;,\&#039;quote\&#039;,\&#039;&#039; . $my_textarea . &#039;\&#039;); void(0);&quot;&gt;&lt;/img&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// What about smileys?<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!empty($context&#91;&#039;smileys&#039;]&#91;&#039;postform&#039;]) || !empty($context&#91;&#039;smileys&#039;]&#91;&#039;popup&#039;]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id=&quot;smileyBox_message&quot;&gt;&lt;/div&gt;&#039;;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// NUEVAS LINEAS DE CÓDIGO AGREGADAS!!<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;, template_control_richedit($context&#91;&#039;post_box_name&#039;], &#039;smileyBox_message&#039;, &#039;bbcBox_message&#039;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// FIN LINEAS DE CÓDIGO!<br /></code><br />Nótese que la función <em>template_control_richedit()</em> es la que incluye todo el código necesario para que aparesca el botón de smileys, sin embargo, además de añadir dicho botón, agregará un <a href="http://www.w3schools.com/tags/tag_textarea.asp" class="bbc_link new_win" target="_blank"><em>textarea</em></a> de más (en realidad ese es el textarea que aparece en la página de action=post, es decir, donde aparece el verdadero formulario de posteo). Para solucionar el problema debemos armarnos nuestro propio <em>template_control_richedit()</em> personalizado, que solo incluya las cosas que queremos que aparescan.<br /><br />Para ello, debemos irnos al archivo themes/default/<strong>GenericControls.template.php</strong> que es donde está la definición de <em>template_control_richedit()</em>, y extraer de ahí las siguientes partes de código:<br /><br />Añadir debajo de:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// What about smileys?<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!empty($context&#91;&#039;smileys&#039;]&#91;&#039;postform&#039;]) || !empty($context&#91;&#039;smileys&#039;]&#91;&#039;popup&#039;]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id=&quot;smileyBox_message&quot;&gt;&lt;/div&gt;&#039;;<br /></code><br />Parte 1 (Inicialización de variables):<br /><br />Estas variables son las que se supone que debe recibir de entrada la subrutina <em>template_control_richedit()</em> (yo se las agrego &quot;artificialmente&quot;).<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$editor_id = $context&#91;&#039;post_box_name&#039;];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$smileyContainer = &#039;smileyBox_message&#039;;<br /></code><br />Esta variable es inicializada desde adentro de la función:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$editor_context = &amp;$context&#91;&#039;controls&#039;]&#91;&#039;richedit&#039;][$editor_id];</code><br />Parte 2 (ésto no viene de <em>template_control_richedit</em>, sino que lo añadí por mi cuenta - Ir a abajo para ver explicaciones):<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;quickReplyContent&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;textarea class=&quot;editor&quot; id=&quot;message&quot; name=&quot;message&quot; cols=&quot;75&quot; rows=&quot;7&quot; style=&quot;&#039;, $context&#91;&#039;browser&#039;]&#91;&#039;is_ie8&#039;] ? &#039;max-width: 100%; min-width: 100%&#039; : &#039;width: 100%&#039;, &#039;; height: 100px;&quot; name=&quot;message&quot; tabindex=&quot;&#039;, $context&#91;&#039;tabindex&#039;]++, &#039; onselect=&quot;storeCaret(this);&quot; onclick=&quot;storeCaret(this);&quot; onkeyup=&quot;storeCaret(this);&quot; onchange=&quot;storeCaret(this);&quot;&gt;&lt;/textarea&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;hidden&quot; name=&quot;&#039;, $editor_id, &#039;_mode&quot; id=&quot;&#039;, $editor_id, &#039;_mode&quot; value=&quot;0&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script type=&quot;text/javascript&quot;&gt;&lt;!-- // --&gt;&lt;![CDATA&#91;&#039;;<br /></code><br />Parte 3 (Definiendo la lista de smileys):<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Show the smileys.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((!empty($context&#91;&#039;smileys&#039;]&#91;&#039;postform&#039;]) || !empty($context&#91;&#039;smileys&#039;]&#91;&#039;popup&#039;])) &amp;&amp; !$editor_context&#91;&#039;disable_smiley_box&#039;] &amp;&amp; $smileyContainer !== null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var oSmileyBox_&#039;, $editor_id, &#039; = new smc_SmileyBox({<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sUniqueId: &#039;, JavaScriptEscape(&#039;smileyBox_&#039; . $editor_id), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sContainerDiv: &#039;, JavaScriptEscape($smileyContainer), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sClickHandler: &#039;, JavaScriptEscape(&#039;oEditorHandle_&#039; . $editor_id . &#039;.insertSmiley&#039;), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oSmileyLocations: {&#039;;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($context&#91;&#039;smileys&#039;] as $location =&gt; $smileyRows)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;, $location, &#039;: &#91;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($smileyRows as $smileyRow)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#91;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($smileyRow&#91;&#039;smileys&#039;] as $smiley)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sCode: &#039;, JavaScriptEscape($smiley&#91;&#039;code&#039;]), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sSrc: &#039;, JavaScriptEscape($settings&#91;&#039;smileys_url&#039;] . &#039;/&#039; . $smiley&#91;&#039;filename&#039;]), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sDescription: &#039;, JavaScriptEscape($smiley&#91;&#039;description&#039;]), &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#039;, empty($smiley&#91;&#039;isLast&#039;]) ? &#039;,&#039; : &#039;&#039;;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]&#039;, empty($smileyRow&#91;&#039;isLast&#039;]) ? &#039;,&#039; : &#039;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]&#039;, $location === &#039;postform&#039; ? &#039;,&#039; : &#039;&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sSmileyBoxTemplate: &#039;, JavaScriptEscape(&#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%smileyRows% %moreSmileys%<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sSmileyRowTemplate: &#039;, JavaScriptEscape(&#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;%smileyRow%&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sSmileyTemplate: &#039;, JavaScriptEscape(&#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img src=&quot;%smileySource%&quot; align=&quot;bottom&quot; alt=&quot;%smileyDescription%&quot; title=&quot;%smileyDescription%&quot; id=&quot;%smileyId%&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMoreSmileysTemplate: &#039;, JavaScriptEscape(&#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href=&quot;#&quot; id=&quot;%moreSmileysId%&quot;&gt;&#91;&#039; . (!empty($context&#91;&#039;smileys&#039;]&#91;&#039;postform&#039;]) ? $txt&#91;&#039;more_smileys&#039;] : $txt&#91;&#039;more_smileys_pick&#039;]) . &#039;]&lt;/a&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039;), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMoreSmileysLinkId: &#039;, JavaScriptEscape(&#039;moreSmileys_&#039; . $editor_id), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMoreSmileysPopupTemplate: &#039;, JavaScriptEscape(&#039;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;&#039; . $txt&#91;&#039;more_smileys_title&#039;] . &#039;&lt;/title&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&#039; . $settings&#91;&#039;theme_url&#039;] . &#039;/css/index&#039; . $context&#91;&#039;theme_variant&#039;] . &#039;.css?rc3&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body id=&quot;help_popup&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;padding windowbg&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;cat_bar&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h3 class=&quot;catbg&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#039; . $txt&#91;&#039;more_smileys_pick&#039;] . &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/h3&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;padding&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%smileyRows%<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;smalltext centertext&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href=&quot;#&quot; id=&quot;%moreSmileysCloseLinkId%&quot;&gt;&#039; . $txt&#91;&#039;more_smileys_close_window&#039;] . &#039;&lt;/a&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;&#039;), &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&#039;;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /></code><br />Parte 4 (Añadiendo plantillas del botón de [mostrar más smileys] y cerrando tag &lt;script&gt;):<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Now it&#039;s all drawn out we&#039;ll actually setup the box.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var oEditorHandle_&#039;, $editor_id, &#039; = new smc_Editor({<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sSessionId: &#039;, JavaScriptEscape($context&#91;&#039;session_id&#039;]), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sSessionVar: &#039;, JavaScriptEscape($context&#91;&#039;session_var&#039;]), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sFormId: &#039;, JavaScriptEscape($editor_context&#91;&#039;form&#039;]), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sUniqueId: &#039;, JavaScriptEscape($editor_id), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bRTL: &#039;, $txt&#91;&#039;lang_rtl&#039;] ? &#039;true&#039; : &#039;false&#039;, &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bWysiwyg: &#039;, $editor_context&#91;&#039;rich_active&#039;] ? &#039;true&#039; : &#039;false&#039;, &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sText: &#039;, JavaScriptEscape($editor_context&#91;&#039;rich_active&#039;] ? $editor_context&#91;&#039;rich_value&#039;] : &#039;&#039;), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sEditWidth: &#039;, JavaScriptEscape($editor_context&#91;&#039;width&#039;]), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sEditHeight: &#039;, JavaScriptEscape($editor_context&#91;&#039;height&#039;]), &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bRichEditOff: &#039;, empty($modSettings&#91;&#039;disable_wysiwyg&#039;]) ? &#039;false&#039; : &#039;true&#039;, &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oSmileyBox: &#039;, !empty($context&#91;&#039;smileys&#039;]&#91;&#039;postform&#039;]) &amp;&amp; !$editor_context&#91;&#039;disable_smiley_box&#039;] &amp;&amp; $smileyContainer !== null ? &#039;oSmileyBox_&#039; . $editor_id : &#039;null&#039;, &#039;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oBBCBox: &#039;, $context&#91;&#039;show_bbc&#039;] &amp;&amp; $bbcContainer !== null ? &#039;oBBCBox_&#039; . $editor_id : &#039;null&#039;, &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smf_editorArray[smf_editorArray.length] = oEditorHandle_&#039;, $editor_id, &#039;;&#039;;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// ]]&gt;&lt;/script&gt;&#039;;<br /></code><br /><br />Por último lo que hay que hacer es comentar la instrucción que añade el textarea del quick reply porque ya no lo vamos a necesitar.<br /><br />Reemplazar:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;quickReplyContent&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;textarea class=&quot;editor&quot; id=&quot;message&quot; name=&quot;message&quot; cols=&quot;75&quot; rows=&quot;7&quot; style=&quot;&#039;, $context&#91;&#039;browser&#039;]&#91;&#039;is_ie8&#039;] ? &#039;max-width: 100%; min-width: 100%&#039; : &#039;width: 100%&#039;, &#039;; height: 100px;&quot; name=&quot;message&quot; tabindex=&quot;&#039;, $context&#91;&#039;tabindex&#039;]++, &#039; onselect=&quot;storeCaret(this);&quot; onclick=&quot;storeCaret(this);&quot; onkeyup=&quot;storeCaret(this);&quot; onchange=&quot;storeCaret(this);&quot;&gt;&lt;/textarea&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;righttext padding&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;submit&quot; name=&quot;post&quot; value=&quot;&#039;, $txt&#91;&#039;post&#039;], &#039;&quot; onclick=&quot;return submitThisOnce(this);&quot; accesskey=&quot;s&quot; tabindex=&quot;&#039;, $context&#91;&#039;tabindex&#039;]++, &#039;&quot; class=&quot;button_submit&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;submit&quot; name=&quot;preview&quot; value=&quot;&#039;, $txt&#91;&#039;preview&#039;], &#039;&quot; onclick=&quot;return submitThisOnce(this);&quot; accesskey=&quot;p&quot; tabindex=&quot;&#039;, $context&#91;&#039;tabindex&#039;]++, &#039;&quot; class=&quot;button_submit&quot; /&gt;&#039;;<br /></code><br />Por:<br /><div class="codeheader">Código: <a href="javascript:void(0);" onclick="return smfSelectText(this);" class="codeoperation">[Seleccionar]</a></div><code class="bbc_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;quickReplyContent&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;textarea class=&quot;editor&quot; id=&quot;message&quot; name=&quot;message&quot; cols=&quot;75&quot; rows=&quot;7&quot; style=&quot;&#039;, $context&#91;&#039;browser&#039;]&#91;&#039;is_ie8&#039;] ? &#039;max-width: 100%; min-width: 100%&#039; : &#039;width: 100%&#039;, &#039;; height: 100px;&quot; name=&quot;message&quot; tabindex=&quot;&#039;, $context&#91;&#039;tabindex&#039;]++, &#039; onselect=&quot;storeCaret(this);&quot; onclick=&quot;storeCaret(this);&quot; onkeyup=&quot;storeCaret(this);&quot; onchange=&quot;storeCaret(this);&quot;&gt;&lt;/textarea&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&#039;;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &#039;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;righttext padding&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;submit&quot; name=&quot;post&quot; value=&quot;&#039;, $txt&#91;&#039;post&#039;], &#039;&quot; onclick=&quot;return submitThisOnce(this);&quot; accesskey=&quot;s&quot; tabindex=&quot;&#039;, $context&#91;&#039;tabindex&#039;]++, &#039;&quot; class=&quot;button_submit&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;submit&quot; name=&quot;preview&quot; value=&quot;&#039;, $txt&#91;&#039;preview&#039;], &#039;&quot; onclick=&quot;return submitThisOnce(this);&quot; accesskey=&quot;p&quot; tabindex=&quot;&#039;, $context&#91;&#039;tabindex&#039;]++, &#039;&quot; class=&quot;button_submit&quot; /&gt;&#039;;<br /></code><br /><span style="font-size: 12pt;" class="bbc_size"><strong>Explicación del paso 2:</strong></span><br />En ese paso es donde la rutina original <em>template_control_richedit()</em> (que no olvidemos que pertenece al proceso action=post) añade el <em>textarea</em> que vemos en el formulario completo de posteo. Lo que hemos hecho es sustituir el código de ese textarea por el textarea propio del quickreply. Por lo visto, es absolutamente necesario añadir el textarea justo antes de los tags &lt;input type=hidden&gt; y &lt;script&gt;<em>código javascript</em>&lt;/script&gt; para que éste haga efecto sobre el textarea.<br /><br /><strong>Nota:</strong> observe que al textarea se le ha añadido unas propiedades que no tenía originalmente: class=&quot;editor&quot; y name=&quot;message&quot;. Dichas propiedades no son necesarias, pero se añadieron pensando que sólo así el javascript lo detectaría, pero luego se comprobó que no.
